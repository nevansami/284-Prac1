     1                                 %line 1+1 obscure_pin.asm
     2                                 [global obscure_pin]
     3                                 
     4                                 [section .data]
     5                                 
     6                                 
     7 00000000 3336343700              pin db "3647", 0
     8 00000005 00                      counter db 0
     9                                 
    10                                 [section .bss]
    11 00000000 <gap>                   obscured resb 100
    12                                 
    13                                 
    14                                 
    15                                 
    16                                 
    17                                 [section .text]
    18                                 obscure_pin:
    19 00000000 55                      push rbp
    20 00000001 4889E5                  mov rbp, rsp
    21                                 
    22                                 
    23                                 
    24                                 
    25                                 
    26 00000004 BB00000000              mov ebx, 0
    27 00000009 31C0                    xor eax, eax
    28 0000000B BE[00000000]            mov esi, pin
    29                                 
    30                                 iterate :
    31 00000010 670FB60E                movzx ecx, byte [esi]
    32 00000014 83F900                  cmp ecx, 0
    33 00000017 7419                    je done
    34 00000019 83E930                  sub ecx, 48
    35 0000001C 83F10F                  xor ecx, 0xF
    36 0000001F 83C130                  add ecx, 48
    37 00000022 67898B[00000000]        mov [obscured + ebx], ecx
    38 00000029 B8[00000000]            mov eax, obscured
    39 0000002E FFC3                    inc ebx
    40 00000030 FFC6                    inc esi
    41 00000032 EBDA                    jmp iterate
    42                                 
    43                                 
    44                                 done:
    45 00000034 B804000000              mov eax, 4
    46 00000039 BB01000000              mov ebx, 1
    47 0000003E B9[00000000]            mov ecx, obscured
    48 00000043 BA04000000              mov edx, 4
    49 00000048 CD80                    int 0x80
    50 0000004A B801000000              mov eax, 1
    51 0000004F CD80                    int 0x80
    52                                 
    53                                 
    54                                 
    55 00000051 C9                      leave
    56 00000052 C3                      ret
